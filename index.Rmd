---
title: "Gov 50 Final Project"
author: "Ee Jenn Lee"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
--- 



## Project thoughts
I am interested in exploring data related to the upcoming Malaysian elections. Making predictions about election outcomes would be cool, but it might also be outside my skill set. I'm particularly interested in exploring the potential effect of a recent law lowering the voting age to 18 on election outcomes, and would look at data sets from youth opinion surveys and state-level elections to explore the role of youth in Malaysian politics. 

## Research proposal
Does voter turnout in Malaysian elections exert an effect on whether the incumbent party is able to remain in power? In this study, I plan to examine data from past Malaysian elections to examine the extent to which there is a correlation between voter turnout and the party that wins. My hypothesis is that lower voter turnout benefits the incumbent party, because dissatisfaction with the administration is often expressed as voter apathy; moreover, specifically in Malaysia, supporters of the regime are incentivized to vote by rewards, financial or otherwise. My sample consists of data from the 14th General Election in 2018. My explanatory variable is voter turnout as a percentage of the voting-age population. My outcome variable is the party that wins the local election, which will be coded discretely and numerically. A significant positive correlation (generated by a multiple regression analysis that adjusts for potential confounders) would support my hypothesis. A negligible or negative correlation would provide evidence against my hypothesis.


```{r DATA CLEANING}
library(tidyverse)

ge14 <- read_csv("~/Desktop/Gov 50/Election-Results-2018 - Parlimen_Results_By_Candidate.csv")
ge14[is.na(ge14)] = 0
ge14$`% of total Votes` <- gsub("%", "", ge14$`% of total Votes`)
ge14$`% of total Votes` <- as.numeric(ge14$`% of total Votes`)
# ge14

turnout <- read_csv("~/Desktop/Gov 50/General-Election-Data-master/Voter Turnout GE12, GE13, GE14 - Sheet1.csv")

turnout$`GE 13 VOTER TURNOUT (2013) %` <- gsub("%", "", turnout$`GE 13 VOTER TURNOUT (2013) %`)
turnout$`GE 13 VOTER TURNOUT (2013) %` <- as.numeric(turnout$`GE 13 VOTER TURNOUT (2013) %`)

turnout$`GE 14 VOTER TURNOUT (2018) %` <- gsub("%", "", turnout$`GE 14 VOTER TURNOUT (2018) %`)
turnout$`GE 14 VOTER TURNOUT (2018) %` <- as.numeric(turnout$`GE 14 VOTER TURNOUT (2018) %`)

turnout$`GE 12 VOTER TURNOUT (2008) %` <- gsub("%", "", turnout$`GE 12 VOTER TURNOUT (2008) %`)
turnout$`GE 12 VOTER TURNOUT (2008) %` <- as.numeric(turnout$`GE 12 VOTER TURNOUT (2008) %`)
# turnout
```


```{r Joining Datasets & Data Cleaning}
library(dplyr)
ge14 <- full_join(turnout, ge14, by = c("PARLIAMENT CODE" = "Seat ID"))

ge14 <- ge14 |>
  transform(
  party_switch,
  party_switch = replace(party_switch, `Candidate Name` == "AMIN AHMAD", 1
                         )) |>
  transform(
  party_switch,
  party_switch = replace(party_switch, PARLIAMENT == "PADANG BESAR", 0)
)  |>
  transform(
  party_switch,
  party_switch = replace(party_switch, PARLIAMENT == "BATU", 0)
) |>
  transform(
  party_switch,
  party_switch = replace(party_switch, PARLIAMENT == "PENAMPANG", 0))
  
# 
# ge14
```


```{r Average Voter Turnout for Incumbent vs Party Switch}
hist <- ge14 |> 
  select(PARLIAMENT, party_switch, GE.14.VOTER.TURNOUT..2018..., Candidate.Win) |>
  filter(Candidate.Win == 1) |>
  group_by(party_switch) |>
  summarize(mean_turnout = mean(GE.14.VOTER.TURNOUT..2018..., na.rm = TRUE
)) |>
  mutate(party_switch = if_else(party_switch == 0, "No", "Yes"))
                                                                       
knitr::kable(hist, digits = 4)
```

```{r Plot}
library(ggplot2)

ggplot(hist, aes(x = party_switch,
                 y = mean_turnout))+
  geom_col(fill = "dodgerblue") + 
  labs(title = "Party switch against voter turnout",
    x = "Party Switch",
      y = "Mean Turnout Percentage(%)") +
  coord_cartesian(ylim=c(75,85)) 
```

```{r}
ge14_partyswitch <- ge14 |>
    select(STATE, `PARLIAMENT.CODE`, `PARLIAMENT`, party_switch, GE.14.VOTER.TURNOUT..2018...) |>
filter(party_switch == 1) 

voteshare_opposition <- c(65.74, 70.86, 71.75, 71.86, 66.92, 66.7, 66.88, 64.53, 70.81, 65.88, 55.24, 58.33, 61.81, 71.18, 71.77, 96.48, 61.65, 64.43, 89.65, 57.02, 59.63, 67.86, 64.26, 78.39, 83.7, 84.74, 82.48, 66.97, 60.9, 55.65, 69.81, 61.34, 59.85, 58.99, 51.69, 58.47, 61.03, 60.19, 63.43, 58.85, 59.01, 73.73, 64.87, 62.31, 69.48, 53.88, 58.42, 67.7, 61.78, 52.59, 58.1, 68.26, 54, 64.07, 60.62, 81.65, 61, 58.55, 56.71, 56.95, 67.18, 52.18, 55.28, 51.11)
ge14_partyswitch$voteshare_opposition <- voteshare_opposition
# ge14_partyswitch

ge14_noswitch <- ge14 |>
filter(party_switch == 0) |>
  filter(Candidate.Win == 1) |>
  select(STATE, `PARLIAMENT.CODE`, `PARLIAMENT`, party_switch, GE.14.VOTER.TURNOUT..2018..., `X..of.total.Votes`) |>
  mutate(voteshare_opposition = 100 - `X..of.total.Votes`) |>
  select(-X..of.total.Votes)
# ge14_noswitch

ge14_turnout_voteshare <- rbind(ge14_partyswitch, ge14_noswitch)
ge14_turnout_voteshare <- ge14_turnout_voteshare[-c(73, 106),]
# ge14_turnout_voteshare

```


```{r}
## Regression on opposition vote share and voter turnout
fit <- lm(voteshare_opposition~GE.14.VOTER.TURNOUT..2018..., data = ge14_turnout_voteshare)
coef(fit)

library(broom)
tidy(fit) |>
  knitr::kable(caption = "Coefficient Estimates for Voter Turnout Against Opposition Performance",
        col.names = c("Predictor", "Estimate", "Std. Error", "Statistic", "P-value"),
        digits = c(0,3,3,3,3))

## Multiple regression controlling for state differences
fit_multi <- lm(voteshare_opposition~GE.14.VOTER.TURNOUT..2018... + STATE, data = ge14_turnout_voteshare)
tidy(fit_multi) |>
  knitr::kable(caption = "Coefficient Estimates for Voter Turnout Against Opposition Performance (controlling for state)",
        col.names = c("Predictor", "Estimate", "Std. Error", "Statistic", "P-value"),
        digits = c(0,3,3,3,3))
```
```{r}
## Scatterplot of regression
fig <- ggplot(ge14_turnout_voteshare,
       aes(x = GE.14.VOTER.TURNOUT..2018..., 
           y = voteshare_opposition)) +
  geom_point(color = "steelblue1") +
  geom_smooth(method = "lm", se = FALSE, color = "indianred1", size = 1.5) +
  labs(x = "GE 14 Voter Turnout",
       y = "Vote share received by the opposition",
       title = "Voter turnout vs opposition performance") 
fig
ggsave("fig.png", fig, width = 10, height = 5)

```


```



